/*
 * 
 * @author Tomas Prerovsky <tomas.prerovsky@gmail.com> 
 * 
 * @section DESCRIPTION
 * 
 * A simple model of the iVeNet <-> TrgsBag  communication modeling the TrgsBAG part.
 * Echos any data received from iVeNet on every heartbeat.  
 * 
 */


Statemachine{
 id{iVeNetMock;};
 States{
   Initial;
   HeartbeatStarted;   
 };
 Actions{
  start_heart_beat{
    start_periodic_timer(1.0*s,IVenetNotify);    
  }; 
  update_state_values{
   ivenet_veh_pos_coord_latitude=ivenet_veh_pos_coord_latitude+1;
   ivenet_veh_pos_coord_altitude=ivenet_veh_pos_coord_altitude+2;
   ivenet_veh_pos_coord_longitude=ivenet_veh_pos_coord_longitude+3;
   ivenet_heartbeat_app_version="iVeNetMockup@sm4ceps";
//     ivenet_veh_own_alignment=
//     ivenet_mast_status=
//     ivenet_radar_in_park_position=
//     
//     ivenet_heartbeat_time_source=
//     ivenet_heartbeat_year=
//     ivenet_heartbeat_month=
//     ivenet_heartbeat_day=
//     ivenet_heartbeat_hour=
//     ivenet_heartbeat_minute=
//     ivenet_heartbeat_second=
//     ivenet_heartbeat_app_version=
//    
  };   
 data_received{
  print("data_received\n");
};

  
 };
 
 //Transition syntax: FROMSTATE;TOSTATE followed by optional action/guard/event (in any order)
 
 Transition{Initial/*from*/;
            HeartbeatStarted/*to*/;
	    start_heart_beat/*action*/;
	    /*no triggering event=> epsilon transition*/};
 Transition{HeartbeatStarted;
            HeartbeatStarted;
	    IVenetNotify;
	    update_state_values;};
 Transition{HeartbeatStarted;
            HeartbeatStarted;
	    TrgsBagNotify;
	    data_received;}; 
 
};


Simulation{
  Start{iVeNetMock;};
};
